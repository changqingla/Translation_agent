# æ™ºèƒ½ç¿»è¯‘ Agent

è¿™æ˜¯ä¸€ä¸ªåŸºäº FastAPI å’Œ LangChain æ„å»ºçš„æ™ºèƒ½ç¿»è¯‘ä»£ç†æœåŠ¡ã€‚å®ƒæä¾›äº†ä¸€ä¸ªå¼‚æ­¥ APIï¼Œç”¨äºå¤„ç†æ–‡æœ¬å’Œæ–‡æ¡£çš„ç¿»è¯‘ä»»åŠ¡ï¼Œå¹¶åˆ©ç”¨å¤§å‹è¯­è¨€æ¨¡å‹æä¾›é«˜è´¨é‡çš„ç¿»è¯‘ç»“æœã€‚

## âœ¨ ä¸»è¦ç‰¹æ€§

- **å¼‚æ­¥ä»»åŠ¡å¤„ç†**: ä½¿ç”¨ FastAPI çš„åå°ä»»åŠ¡ï¼Œå®ç°éé˜»å¡çš„ç¿»è¯‘è¯·æ±‚å¤„ç†ï¼Œé€‚åˆå¤„ç†å¤§å‹æ–‡æ¡£æˆ–è€—æ—¶è¾ƒé•¿çš„ç¿»è¯‘ä»»åŠ¡ã€‚
- **é«˜æ€§èƒ½ç¿»è¯‘å¼•æ“**:
  - **å¹¶è¡Œå¤„ç†**: é€šè¿‡å¹¶è¡Œå¤„ç†æ–‡æ¡£å—ç»„ï¼Œæœ€å¤§åŒ–ç¿»è¯‘æ•ˆç‡ã€‚
  - **ä¸Šä¸‹æ–‡æ„ŸçŸ¥**: åœ¨ç»„å†…æŒ‰é¡ºåºç¿»è¯‘æ–‡æœ¬å—ï¼Œä»¥ä¿æŒç¿»è¯‘çš„è¿è´¯æ€§å’Œä¸Šä¸‹æ–‡å‡†ç¡®æ€§ã€‚
  - **å¹¶å‘æ§åˆ¶**: ä½¿ç”¨ä¿¡å·é‡æ§åˆ¶å¯¹å¤–éƒ¨APIçš„å¹¶å‘è¯·æ±‚ï¼Œé˜²æ­¢é€Ÿç‡é™åˆ¶æˆ–æœåŠ¡è¿‡è½½ã€‚
- **æ”¯æŒè‡ªå®šä¹‰æœ¯è¯­**: å…è®¸ç”¨æˆ·æä¾›æœ¯è¯­è¯å…¸ï¼Œç¡®ä¿ç‰¹å®šæœ¯è¯­åœ¨ç¿»è¯‘è¿‡ç¨‹ä¸­çš„ä¸€è‡´æ€§å’Œå‡†ç¡®æ€§ã€‚
- **å¯é…ç½®å’Œå¯æ‰©å±•**:
  - **æ¨¡å‹çµæ´»**: æ”¯æŒé…ç½®ä¸åŒçš„OpenAIæ¨¡å‹ï¼ˆæˆ–å…¶ä»–å…¼å®¹çš„LLMï¼‰ã€‚
  - **æ˜“äºé›†æˆ**: æä¾›æ¸…æ™°çš„ RESTful API æ¥å£ï¼Œæ–¹ä¾¿ä¸å…¶ä»–æœåŠ¡é›†æˆã€‚
- **è¯¦ç»†çš„æ—¥å¿—è®°å½•**: å†…ç½®ç»“æ„åŒ–æ—¥å¿—ï¼Œæ–¹ä¾¿è¿½è¸ªå’Œè°ƒè¯•ã€‚
- **å¤šç§æ–‡æ¡£æ ¼å¼æ”¯æŒ**: æ”¯æŒå¤„ç†çº¯æ–‡æœ¬ã€PDFã€DOCX ç­‰å¤šç§æ ¼å¼çš„å†…å®¹ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

- Python 3.8+
- poetry (å¯é€‰, ç”¨äºä¾èµ–ç®¡ç†)

### 2. å®‰è£…ä¾èµ–

å…‹éš†æœ¬é¡¹ç›®åˆ°æœ¬åœ°ï¼š
```bash
git clone https://github.com/your-username/Translation_agent.git
cd Translation_agent/src
```

å®‰è£…æ‰€éœ€çš„ä¾èµ–åŒ…ï¼š
```bash
pip install -r requirements.txt
```

### 3. é…ç½®

åœ¨ `src/` ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª `.env` æ–‡ä»¶ï¼Œå¹¶å¡«å…¥å¿…è¦çš„é…ç½®ä¿¡æ¯ã€‚

```env
OPENAI_API_KEY="sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
# å¦‚æœä½¿ç”¨è‡ªå®šä¹‰çš„OpenAIå…¼å®¹APIï¼Œè¯·è®¾ç½®æ­¤é¡¹
OPENAI_BASE_URL="https://api.openai.com/v1" 
```

ä½ ä¹Ÿå¯ä»¥åœ¨ `src/config.py` æ–‡ä»¶ä¸­ä¿®æ”¹é»˜è®¤çš„æ¨¡å‹ã€å¹¶å‘æ•°ç­‰è®¾ç½®ã€‚

### 4. å¯åŠ¨æœåŠ¡

```bash
python main.py
```
æˆ–è€…ä½¿ç”¨ `uvicorn` è¿›è¡Œçƒ­é‡è½½å¼€å‘ï¼š
```bash
uvicorn main:app --host 0.0.0.0 --port 8099 --reload
```
æœåŠ¡å¯åŠ¨åï¼ŒAPIå°†åœ¨ `http://localhost:8099` ä¸Šå¯ç”¨ã€‚

## ğŸ“š API æ–‡æ¡£

æœåŠ¡å¯åŠ¨åï¼Œä½ å¯ä»¥åœ¨ [http://localhost:8099/docs](http://localhost:8099/docs) è®¿é—®è‡ªåŠ¨ç”Ÿæˆçš„ Swagger UI API æ–‡æ¡£ã€‚

### ä¸»è¦ç«¯ç‚¹

#### `POST /translation/start`

å¯åŠ¨ä¸€ä¸ªå¼‚æ­¥ç¿»è¯‘ä»»åŠ¡ã€‚

- **è¯·æ±‚ä½“**:
```json
{
  "content": "This is the text to be translated.",
  "target_language": "ä¸­æ–‡",
  "terminology": {
    "text": "æ–‡æœ¬"
  }
}
```
- **æˆåŠŸå“åº” (202 Accepted)**:
```json
{
  "task_id": "some-unique-task-id",
  "status_url": "http://localhost:8099/translation/status/some-unique-task-id",
  "result_url": "http://localhost:8099/translation/result/some-unique-task-id"
}
```

#### `GET /translation/status/{task_id}`

æŸ¥è¯¢ç¿»è¯‘ä»»åŠ¡çš„å½“å‰çŠ¶æ€ã€‚

- **æˆåŠŸå“åº” (200 OK)**:
```json
{
  "task_id": "some-unique-task-id",
  "status": "running", // "pending", "running", "completed", "error"
  "error": null
}
```

#### `GET /translation/result/{task_id}`

è·å–ç¿»è¯‘ä»»åŠ¡çš„ç»“æœã€‚

- **æˆåŠŸå“åº” (200 OK)**:
```json
{
  "task_id": "some-unique-task-id",
  "status": "completed",
  "translated_content": "è¿™æ˜¯å¾…ç¿»è¯‘çš„æ–‡æœ¬ã€‚",
  "original_content": "This is the text to be translated.",
  "target_language": "ä¸­æ–‡",
  "usage": {
    "total_input_tokens": 10,
    "total_output_tokens": 8
  }
}
```

- **ä»»åŠ¡å¤„ç†ä¸­å“åº” (202 Accepted)**:
```json
{
  "detail": "ä»»åŠ¡ä»åœ¨å¤„ç†ä¸­ï¼Œå½“å‰çŠ¶æ€: running"
}
```

## ğŸ“ é¡¹ç›®ç»“æ„
```
Translation_agent/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api/             # FastAPIç›¸å…³ï¼ŒåŒ…æ‹¬æ¨¡å‹ã€æœåŠ¡å’Œä»»åŠ¡ç®¡ç†å™¨
â”‚   â”œâ”€â”€ core/            # æ ¸å¿ƒç¿»è¯‘é€»è¾‘ï¼ŒåŒ…æ‹¬æ–‡æ¡£åˆ†å—å’Œç¿»è¯‘å¼•æ“
â”‚   â”œâ”€â”€ utils/           # å·¥å…·å‡½æ•°ï¼Œå¦‚æ—¥å¿—å’Œtokenè®¡ç®—
â”‚   â”œâ”€â”€ logs/            # æ—¥å¿—æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ main.py          # FastAPIåº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ config.py        # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ requirements.txt # Pythonä¾èµ–
â”‚   â””â”€â”€ .env.example     # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â””â”€â”€ README.md
```
